<%- include('partials/head-meta', { title, description, canonical, noindex: typeof noindex !== 'undefined' ? noindex : true }) %>
<%- include('partials/header') %>

<% if (typeof isDir !== 'undefined' && isDir) { %>
  <main class="main-content">
    <section class="gracias-section">
      <div class="container" style="max-width:760px;margin:0 auto;padding:2rem 1rem;">
        <h1 style="font-size:1.6rem;margin:0 0 .5rem;">Directorio ‚Äî Confirma tu acceso</h1>
        <p style="margin:0 0 1rem;">
          Te hemos enviado un enlace seguro al correo
          <% if (emailShown) { %><strong><%= emailShown %></strong><% } else { %>que nos indicaste<% } %>.
        </p>
        <ul style="line-height:1.7;margin:0 0 1rem;padding-left:1.2rem;">
          <li>Abre el email y pulsa el enlace para entrar.</li>
          <li>El acceso es v√°lido 60 d√≠as y se renueva autom√°ticamente cuando lo usas.</li>
          <li>Si no lo ves, revisa <strong>Spam/Promociones</strong> o espera 2 minutos.</li>
        </ul>
        <div style="margin-top:1rem;">
          <a href="/dir" class="btn" style="display:inline-block;padding:.7rem 1rem;border:1px solid #222;border-radius:10px;text-decoration:none;">Volver al Directorio</a>
          <a href="/" class="btn" style="display:inline-block;margin-left:.5rem;padding:.7rem 1rem;border:1px solid #ccc;border-radius:10px;text-decoration:none;">Ir al inicio</a>
        </div>
      </div>
    </section>

    <!-- Analytics opcional -->
    <script>
      (function(){
        window.dataLayer = window.dataLayer || [];
        dataLayer.push({ event: 'dir_signup_complete' });
      })();
    </script>
  </main>
<% } else { %>
  <main class="main-content">
      <section class="gracias-section">
          <div class="container">
              <div class="gracias-content">
                  <div class="gracias-icon">üéâ</div>
                  <h1 class="gracias-title">¬°Gracias!</h1>
                  <% if (typeof recurso !== 'undefined' && recurso) { %>
                    <p class="gracias-subtitle">Tu descarga est√° lista. Esperamos que te sea de gran valor.</p>
                    
                    <div class="download-action">
                        <a href="<%= recurso.pdf %>" id="btn-download" class="btn btn-primary btn-large">
                            <span class="btn-icon">üì•</span>
                            Descargar PDF
                        </a>
                    </div>

                    <section class="next-steps">
                        <h2>Siguientes pasos recomendados</h2>
                        <div class="steps-grid">
                            <div class="step-card">
                                <h3>üìÇ Explora m√°s recursos</h3>
                                <p>Descubre otras gu√≠as y herramientas</p>
                                <a href="/recursos" class="btn btn-secondary">Ver todos los recursos</a>
                            </div>
                            <div class="step-card">
                                <h3>üè¢ Directorio vivo</h3>
                                <p>Encuentra proveedores sostenibles</p>
                                <a href="/dir" class="btn btn-secondary">Acceder al directorio</a>
                            </div>
                            <div class="step-card">
                                <h3>üìã Plantillas √∫tiles</h3>
                                <p>Herramientas pr√°cticas para tu proyecto</p>
                                <a href="/plantillas" class="btn btn-secondary">Ver plantillas</a>
                            </div>
                        </div>
                    </section>
                  <% } else { %>
                    <p>Tu solicitud se ha enviado correctamente.</p>
                  <% } %>
              </div>
          </div>
      </section>
  </main>

  <script src="/assets/js/script.js"></script>
  <% if (typeof recurso !== 'undefined' && recurso) { %>
  <script>
      document.getElementById('btn-download')?.addEventListener('click', function(){
          // Aqu√≠ puedes disparar un evento de anal√≠tica si usas GTM/GA4
          console.log('Descarga iniciada:', '<%= recurso.title %>');
      });
  </script>
  <% } %>
<% } %>

<%- include('partials/footer') %>
</body>
</html>
